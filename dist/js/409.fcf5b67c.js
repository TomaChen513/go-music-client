"use strict";(self["webpackChunkmusic_client"]=self["webpackChunkmusic_client"]||[]).push([[409],{8045:function(e,t,n){n.d(t,{Z:function(){return l}});var a=n(3396),r=n(9749),s=n(3658),o=n(2167);function l(){const{proxy:e}=(0,a.FN)(),t=(0,r.oR)(),n=(0,a.Fl)((()=>t.getters.token));function l(e){return 0===e?"女":1===e?"男":void 0}function c(e){return e.split("-")[1]}function i(e){return e.split("-")[0]}function u(t){return!!n.value||(!1!==t&&e.$message({message:"请先登录",type:"warning"}),!1)}function g({id:t,url:n,pic:a,index:r,name:s,lyric:o,currentSongList:l}){const u=c(s),g=i(s);e.$store.dispatch("playMusic",{id:t,url:n,pic:a,index:r,songTitle:u,singerName:g,lyric:o,currentSongList:l})}async function p({songUrl:t,songName:n}){if(!t)return e.$message({message:"下载链接为空！",type:"error"}),void console.error("下载链接为空！");const a=await o.x.downloadMusic(t),r=document.createElement("a");r.download=`${n}.mp3`,r.style.display="none";const s=new Blob([a.data]);r.href=URL.createObjectURL(s),document.body.appendChild(r),r.click(),document.body.removeChild(r)}function d(t){e.$store.commit("setActiveNavName",t)}function m(t,n){switch(t){case s.wC.Search:e.$router.push({path:n.path,query:n.query});break;case s.wC.Home:case s.wC.SongSheet:case s.wC.SongSheetDetail:case s.wC.Singer:case s.wC.SingerDetail:case s.wC.Personal:case s.wC.PersonalData:case s.wC.Setting:case s.wC.SignIn:case s.wC.SignUp:case s.wC.SignOut:case s.wC.Lyric:case s.wC.Error:default:e.$router.push({path:n.path});break}}function f(t=-1){e.$router.go(t)}return{getUserSex:l,getSongTitle:c,getSingerName:i,changeIndex:d,checkStatus:u,playMusic:g,routerManager:m,goBack:f,downloadMusic:p}}},2024:function(e,t,n){function a(e){if(null==e||""==e)return"";const t=new Date(e),n=t.getFullYear(),a=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,r=t.getDate()<10?"0"+t.getDate():t.getDate();return n+"-"+a+"-"+r}function r(e){if(null==e||""==e)return"";const t=new Date(e),n=t.getFullYear(),a=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,r=t.getDate()<10?"0"+t.getDate():t.getDate(),s=t.getHours()<10?"0"+t.getHours():t.getHours(),o=t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes(),l=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds();return n+"-"+a+"-"+r+" "+s+":"+o+":"+l}function s(e){let t=e.split("\n");const n=/\[\d{2}:\d{2}.(\d{3}|\d{2})\]/g,a=[];if(!/\[.+\]/.test(e))return[[0,e]];while(!n.test(t[0]))t=t.slice(1);0===t[t.length-1].length&&t.pop();for(const r of t){const e=r.match(n),t=r.replace(n,"");for(const n of e){const e=n.slice(1,-1).split(":");""!==t&&a.push([60*parseInt(e[0],10)+parseFloat(e[1]),t])}}return a.sort(((e,t)=>e[0]-t[0])),a}function o(e){let t=parseInt(e),n=0,a=0;t>60&&(n=parseInt((t/60).toString()),t=parseInt((t%60).toString()),n>60&&(a=parseInt((n/60).toString()),n=60));let r="";return r=parseInt(t.toString())<10?"0:0"+parseInt(t.toString()):"0:"+parseInt(t.toString()),n>0&&(r=parseInt(t.toString())<10?"0"+parseInt(t.toString()):parseInt(t.toString()).toString(),r=parseInt(n.toString())+":"+r),a>0&&(r=parseInt(t.toString())<10?"0"+parseInt(t.toString()):parseInt(t.toString()).toString(),r=parseInt(a.toString())+":"+parseInt(n.toString())+":"+r),r}n.d(t,{oy:function(){return a},p6:function(){return r},zu:function(){return s},ZC:function(){return o}})},4243:function(e,t,n){n.d(t,{Z:function(){return F}});var a=n(3396),r=n(7139);const s=e=>((0,a.dD)("data-v-2c9fdbbb"),e=e(),(0,a.Cn)(),e),o={class:"comment"},l={class:"comment-title"},c=s((()=>(0,a._)("span",null,"评论",-1))),i={class:"comment-desc"},u=(0,a.Uk)("发表评论"),g={class:"popular"},p={class:"popular-msg"},d={class:"name"},m={class:"time"},f={class:"content"},y=["onClick"];function v(e,t,n,s,v,h){const w=(0,a.up)("el-input"),S=(0,a.up)("el-button"),I=(0,a.up)("el-image"),C=(0,a.up)("yin-icon"),_=(0,a.up)("delete"),k=(0,a.up)("el-icon");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",o,[(0,a._)("h2",l,[c,(0,a._)("span",i,"共 "+(0,r.zw)(e.commentList.length)+" 条评论",1)]),(0,a.Wm)(w,{class:"comment-input",type:"textarea",placeholder:"期待您的精彩评论...",rows:2,modelValue:e.textarea,"onUpdate:modelValue":t[0]||(t[0]=t=>e.textarea=t)},null,8,["modelValue"]),(0,a.Wm)(S,{class:"sub-btn",type:"primary",onClick:t[1]||(t[1]=t=>e.submitComment())},{default:(0,a.w5)((()=>[u])),_:1})]),(0,a._)("ul",g,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.commentList,((t,n)=>((0,a.wg)(),(0,a.iD)("li",{key:n},[(0,a.Wm)(I,{class:"popular-img",fit:"contain",src:e.attachImageUrl(t.avator)},null,8,["src"]),(0,a._)("div",p,[(0,a._)("ul",null,[(0,a._)("li",d,(0,r.zw)(t.username),1),(0,a._)("li",m,(0,r.zw)(e.formatDate(t.createTime)),1),(0,a._)("li",f,(0,r.zw)(t.content),1)])]),(0,a._)("div",{class:"comment-ctr",onClick:a=>e.setSupport(t.id,t.up,n)},[(0,a._)("div",null,[(0,a.Wm)(C,{icon:e.iconList.Support},null,8,["icon"]),(0,a.Uk)(" "+(0,r.zw)(t.up),1)]),t.userId===e.userId?((0,a.wg)(),(0,a.j4)(k,{key:0,onClick:a=>e.deleteComment(t.id,n)},{default:(0,a.w5)((()=>[(0,a.Wm)(_)])),_:2},1032,["onClick"])):(0,a.kq)("",!0)],8,y)])))),128))])],64)}var h=n(4870),w=n(9749),S=n(547),I=n(3089),C=n(8045),_=n(2167),k=n(3658),x=n(2024),D=(0,a.aZ)({components:{YinIcon:I.Z,Delete:S.Z},props:{playId:Number||String,type:Number},setup(e){const{proxy:t}=(0,a.FN)(),n=(0,w.oR)(),{checkStatus:r}=(0,C.Z)(),{playId:s,type:o}=(0,h.BK)(e),l=(0,h.iH)([]),c=(0,h.iH)(""),i=(0,h.qj)({Support:k.JO.Support}),u=(0,a.Fl)((()=>n.getters.userId)),g=(0,a.Fl)((()=>n.getters.songId));async function p(){try{const e=await _.x.getAllComment(o.value,s.value);l.value=e.data;for(let t=0;t<l.value.length;t++){const e=await _.x.getUserOfId(l.value[t].userId);l.value[t].avator=e.data[0].avator,l.value[t].username=e.data[0].username}}catch(e){console.error(e)}}async function d(){if(!r())return;const e=new URLSearchParams;1===o.value?e.append("songListId",`${s.value}`):0===o.value&&e.append("songId",`${s.value}`),e.append("userId",u.value),e.append("type",`${o.value}`),e.append("content",c.value);const n=await _.x.setComment(e);t.$message({message:n.message,type:n.type}),n.success&&(c.value="",await p())}async function m(e,n){const a=await _.x.deleteComment(e);t.$message({message:a.message,type:a.type}),a.success&&l.value.splice(n,1)}async function f(e,n,a){if(!r())return;const s=new URLSearchParams;s.append("id",e),s.append("up",n+1);const o=await _.x.setSupport(s);o.success&&(t.$refs.up[a].children[0].style.color="#2796dd",await p())}return(0,a.YP)(g,(()=>{p()})),(0,a.bv)((()=>{p()})),{userId:u,commentList:l,textarea:c,iconList:i,attachImageUrl:_.x.attachImageUrl,submitComment:d,setSupport:f,formatDate:x.p6,deleteComment:m}}}),b=n(89);const U=(0,b.Z)(D,[["render",v],["__scopeId","data-v-2c9fdbbb"]]);var F=U},3089:function(e,t,n){n.d(t,{Z:function(){return u}});var a=n(3396);const r={class:"icon","aria-hidden":"true"},s=["xlink:href"];function o(e,t,n,o,l,c){return(0,a.wg)(),(0,a.iD)("svg",r,[(0,a._)("use",{"xlink:href":e.icon},null,8,s)])}var l=(0,a.aZ)({props:{icon:String}}),c=n(89);const i=(0,c.Z)(l,[["render",o]]);var u=i},1409:function(e,t,n){n.r(t),n.d(t,{default:function(){return k}});var a=n(3396),r=n(7139),s=n(9242);const o=e=>((0,a.dD)("data-v-a931a724"),e=e(),(0,a.Cn)(),e),l={class:"song-container"},c={class:"song-info"},i={class:"container"},u={class:"lyric-container"},g={class:"song-lyric"},p={class:"no-lyric",key:"no-lyric"},d=o((()=>(0,a._)("span",null,"暂无歌词",-1))),m=[d];function f(e,t,n,o,d,f){const y=(0,a.up)("el-image"),v=(0,a.up)("comment");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",l,[(0,a.Wm)(y,{class:"song-pic",fit:"contain",src:e.attachImageUrl(e.songPic)},null,8,["src"]),(0,a._)("ul",c,[(0,a._)("li",null,"歌手："+(0,r.zw)(e.singerName),1),(0,a._)("li",null,"歌曲："+(0,r.zw)(e.songTitle),1)])]),(0,a._)("div",i,[(0,a._)("div",u,[(0,a._)("div",g,[(0,a.Wm)(s.W3,{name:"lyric-fade"},{default:(0,a.w5)((()=>[e.lyricArr.length?((0,a.wg)(),(0,a.iD)("ul",{style:(0,r.j5)({top:e.lrcTop}),class:"has-lyric",key:"has-lyric"},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.lyricArr,((e,t)=>((0,a.wg)(),(0,a.iD)("li",{key:t},(0,r.zw)(e[1]),1)))),128))],4)):((0,a.wg)(),(0,a.iD)("div",p,m))])),_:1})]),(0,a.Wm)(v,{playId:e.songId,type:0},null,8,["playId"])])])],64)}var y=n(4870),v=n(9749),h=n(4243),w=n(2024),S=n(2167),I=(0,a.aZ)({components:{Comment:h.Z},setup(){const e=(0,v.oR)(),t=(0,y.iH)("80px"),n=(0,y.iH)([]),r=(0,a.Fl)((()=>e.getters.songId)),s=(0,a.Fl)((()=>e.getters.lyric)),o=(0,a.Fl)((()=>e.getters.currentPlayList)),l=(0,a.Fl)((()=>e.getters.currentPlayIndex)),c=(0,a.Fl)((()=>e.getters.curTime)),i=(0,a.Fl)((()=>e.getters.songTitle)),u=(0,a.Fl)((()=>e.getters.singerName)),g=(0,a.Fl)((()=>e.getters.songPic));return(0,a.YP)(r,(()=>{n.value=(0,w.zu)(o.value[l.value].lyric)})),(0,a.YP)(c,(()=>{if(0!==n.value.length)for(let e=0;e<n.value.length;e++)if(c.value>=n.value[e][0]){for(let e=0;e<n.value.length;e++)document.querySelectorAll(".has-lyric li")[e].style.color="#000",document.querySelectorAll(".has-lyric li")[e].style.fontSize="14px";e>=0&&(t.value=30*-e+50+"px",document.querySelectorAll(".has-lyric li")[e].style.color="#95d2f6",document.querySelectorAll(".has-lyric li")[e].style.fontSize="18px")}})),n.value=s.value?(0,w.zu)(s.value):[],{songPic:g,singerName:u,songTitle:i,lrcTop:t,lyricArr:n,songId:r,attachImageUrl:S.x.attachImageUrl}}}),C=n(89);const _=(0,C.Z)(I,[["render",f],["__scopeId","data-v-a931a724"]]);var k=_}}]);
//# sourceMappingURL=409.fcf5b67c.js.map