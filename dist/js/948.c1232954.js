"use strict";(self["webpackChunkmusic_client"]=self["webpackChunkmusic_client"]||[]).push([[948],{8045:function(e,t,n){n.d(t,{Z:function(){return r}});var a=n(3396),o=n(9749),s=n(3658),l=n(2167);function r(){const{proxy:e}=(0,a.FN)(),t=(0,o.oR)(),n=(0,a.Fl)((()=>t.getters.token));function r(e){return 0===e?"女":1===e?"男":void 0}function i(e){return e.split("-")[1]}function c(e){return e.split("-")[0]}function u(t){return!!n.value||(!1!==t&&e.$message({message:"请先登录",type:"warning"}),!1)}function d({id:t,url:n,pic:a,index:o,name:s,lyric:l,currentSongList:r}){const u=i(s),d=c(s);e.$store.dispatch("playMusic",{id:t,url:n,pic:a,index:o,songTitle:u,singerName:d,lyric:l,currentSongList:r})}async function p({songUrl:t,songName:n}){if(!t)return e.$message({message:"下载链接为空！",type:"error"}),void console.error("下载链接为空！");const a=await l.x.downloadMusic(t),o=document.createElement("a");o.download=`${n}.mp3`,o.style.display="none";const s=new Blob([a.data]);o.href=URL.createObjectURL(s),document.body.appendChild(o),o.click(),document.body.removeChild(o)}function g(t){e.$store.commit("setActiveNavName",t)}function m(t,n){switch(t){case s.wC.Search:e.$router.push({path:n.path,query:n.query});break;case s.wC.Home:case s.wC.SongSheet:case s.wC.SongSheetDetail:case s.wC.Singer:case s.wC.SingerDetail:case s.wC.Personal:case s.wC.PersonalData:case s.wC.Setting:case s.wC.SignIn:case s.wC.SignUp:case s.wC.SignOut:case s.wC.Lyric:case s.wC.Error:default:e.$router.push({path:n.path});break}}function w(t=-1){e.$router.go(t)}return{getUserSex:r,getSongTitle:i,getSingerName:c,changeIndex:g,checkStatus:u,playMusic:d,routerManager:m,goBack:w,downloadMusic:p}}},2024:function(e,t,n){function a(e){if(null==e||""==e)return"";const t=new Date(e),n=t.getFullYear(),a=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,o=t.getDate()<10?"0"+t.getDate():t.getDate();return n+"-"+a+"-"+o}function o(e){if(null==e||""==e)return"";const t=new Date(e),n=t.getFullYear(),a=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,o=t.getDate()<10?"0"+t.getDate():t.getDate(),s=t.getHours()<10?"0"+t.getHours():t.getHours(),l=t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes(),r=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds();return n+"-"+a+"-"+o+" "+s+":"+l+":"+r}function s(e){let t=e.split("\n");const n=/\[\d{2}:\d{2}.(\d{3}|\d{2})\]/g,a=[];if(!/\[.+\]/.test(e))return[[0,e]];while(!n.test(t[0]))t=t.slice(1);0===t[t.length-1].length&&t.pop();for(const o of t){const e=o.match(n),t=o.replace(n,"");for(const n of e){const e=n.slice(1,-1).split(":");""!==t&&a.push([60*parseInt(e[0],10)+parseFloat(e[1]),t])}}return a.sort(((e,t)=>e[0]-t[0])),a}function l(e){let t=parseInt(e),n=0,a=0;t>60&&(n=parseInt((t/60).toString()),t=parseInt((t%60).toString()),n>60&&(a=parseInt((n/60).toString()),n=60));let o="";return o=parseInt(t.toString())<10?"0:0"+parseInt(t.toString()):"0:"+parseInt(t.toString()),n>0&&(o=parseInt(t.toString())<10?"0"+parseInt(t.toString()):parseInt(t.toString()).toString(),o=parseInt(n.toString())+":"+o),a>0&&(o=parseInt(t.toString())<10?"0"+parseInt(t.toString()):parseInt(t.toString()).toString(),o=parseInt(a.toString())+":"+parseInt(n.toString())+":"+o),o}n.d(t,{oy:function(){return a},p6:function(){return o},zu:function(){return s},ZC:function(){return l}})},4243:function(e,t,n){n.d(t,{Z:function(){return U}});var a=n(3396),o=n(7139);const s=e=>((0,a.dD)("data-v-2c9fdbbb"),e=e(),(0,a.Cn)(),e),l={class:"comment"},r={class:"comment-title"},i=s((()=>(0,a._)("span",null,"评论",-1))),c={class:"comment-desc"},u=(0,a.Uk)("发表评论"),d={class:"popular"},p={class:"popular-msg"},g={class:"name"},m={class:"time"},w={class:"content"},f=["onClick"];function h(e,t,n,s,h,v){const S=(0,a.up)("el-input"),y=(0,a.up)("el-button"),I=(0,a.up)("el-image"),k=(0,a.up)("yin-icon"),C=(0,a.up)("delete"),_=(0,a.up)("el-icon");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",l,[(0,a._)("h2",r,[i,(0,a._)("span",c,"共 "+(0,o.zw)(e.commentList.length)+" 条评论",1)]),(0,a.Wm)(S,{class:"comment-input",type:"textarea",placeholder:"期待您的精彩评论...",rows:2,modelValue:e.textarea,"onUpdate:modelValue":t[0]||(t[0]=t=>e.textarea=t)},null,8,["modelValue"]),(0,a.Wm)(y,{class:"sub-btn",type:"primary",onClick:t[1]||(t[1]=t=>e.submitComment())},{default:(0,a.w5)((()=>[u])),_:1})]),(0,a._)("ul",d,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.commentList,((t,n)=>((0,a.wg)(),(0,a.iD)("li",{key:n},[(0,a.Wm)(I,{class:"popular-img",fit:"contain",src:e.attachImageUrl(t.avator)},null,8,["src"]),(0,a._)("div",p,[(0,a._)("ul",null,[(0,a._)("li",g,(0,o.zw)(t.username),1),(0,a._)("li",m,(0,o.zw)(e.formatDate(t.createTime)),1),(0,a._)("li",w,(0,o.zw)(t.content),1)])]),(0,a._)("div",{class:"comment-ctr",onClick:a=>e.setSupport(t.id,t.up,n)},[(0,a._)("div",null,[(0,a.Wm)(k,{icon:e.iconList.Support},null,8,["icon"]),(0,a.Uk)(" "+(0,o.zw)(t.up),1)]),t.userId===e.userId?((0,a.wg)(),(0,a.j4)(_,{key:0,onClick:a=>e.deleteComment(t.id,n)},{default:(0,a.w5)((()=>[(0,a.Wm)(C)])),_:2},1032,["onClick"])):(0,a.kq)("",!0)],8,f)])))),128))])],64)}var v=n(4870),S=n(9749),y=n(547),I=n(3089),k=n(8045),C=n(2167),_=n(3658),b=n(2024),x=(0,a.aZ)({components:{YinIcon:I.Z,Delete:y.Z},props:{playId:Number||String,type:Number},setup(e){const{proxy:t}=(0,a.FN)(),n=(0,S.oR)(),{checkStatus:o}=(0,k.Z)(),{playId:s,type:l}=(0,v.BK)(e),r=(0,v.iH)([]),i=(0,v.iH)(""),c=(0,v.qj)({Support:_.JO.Support}),u=(0,a.Fl)((()=>n.getters.userId)),d=(0,a.Fl)((()=>n.getters.songId));async function p(){try{const e=await C.x.getAllComment(l.value,s.value);r.value=e.data;for(let t=0;t<r.value.length;t++){const e=await C.x.getUserOfId(r.value[t].userId);r.value[t].avator=e.data[0].avator,r.value[t].username=e.data[0].username}}catch(e){console.error(e)}}async function g(){if(!o())return;const e=new URLSearchParams;1===l.value?e.append("songListId",`${s.value}`):0===l.value&&e.append("songId",`${s.value}`),e.append("userId",u.value),e.append("type",`${l.value}`),e.append("content",i.value);const n=await C.x.setComment(e);t.$message({message:n.message,type:n.type}),n.success&&(i.value="",await p())}async function m(e,n){const a=await C.x.deleteComment(e);t.$message({message:a.message,type:a.type}),a.success&&r.value.splice(n,1)}async function w(e,n,a){if(!o())return;const s=new URLSearchParams;s.append("id",e),s.append("up",n+1);const l=await C.x.setSupport(s);l.success&&(t.$refs.up[a].children[0].style.color="#2796dd",await p())}return(0,a.YP)(d,(()=>{p()})),(0,a.bv)((()=>{p()})),{userId:u,commentList:r,textarea:i,iconList:c,attachImageUrl:C.x.attachImageUrl,submitComment:g,setSupport:w,formatDate:b.p6,deleteComment:m}}}),D=n(89);const L=(0,D.Z)(x,[["render",h],["__scopeId","data-v-2c9fdbbb"]]);var U=L},373:function(e,t,n){n.d(t,{Z:function(){return b}});var a=n(3396);const o={class:"content"},s=(0,a.Uk)("下载"),l=(0,a.Uk)("删除");function r(e,t,n,r,i,c){const u=(0,a.up)("el-table-column"),d=(0,a.up)("MoreFilled"),p=(0,a.up)("el-icon"),g=(0,a.up)("el-dropdown-item"),m=(0,a.up)("el-dropdown-menu"),w=(0,a.up)("el-dropdown"),f=(0,a.up)("el-table");return(0,a.wg)(),(0,a.iD)("div",o,[(0,a.Wm)(f,{"highlight-current-row":"",data:e.dataList,onRowClick:e.handleClick},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{prop:"songName",label:"歌曲"}),(0,a.Wm)(u,{prop:"singerName",label:"歌手"}),(0,a.Wm)(u,{prop:"introduction",label:"专辑"}),(0,a.Wm)(u,{label:"编辑",width:"80",align:"center"},{default:(0,a.w5)((t=>[(0,a.Wm)(w,null,{dropdown:(0,a.w5)((()=>[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,{icon:e.Download,onClick:n=>e.downloadMusic({songUrl:t.row.url,songName:t.row.name})},{default:(0,a.w5)((()=>[s])),_:2},1032,["icon","onClick"]),e.show?((0,a.wg)(),(0,a.j4)(g,{key:0,icon:e.Delete,onClick:n=>e.deleteCollection({id:t.row.id})},{default:(0,a.w5)((()=>[l])),_:2},1032,["icon","onClick"])):(0,a.kq)("",!0)])),_:2},1024)])),default:(0,a.w5)((()=>[(0,a.Wm)(p,{onClick:n=>e.handleEdit(t.row)},{default:(0,a.w5)((()=>[(0,a.Wm)(d)])),_:2},1032,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data","onRowClick"])])}var i=n(4870),c=n(9749),u=n(8045),d=n(9092),p=n(547),g=n(6854);const m=(0,a.aZ)({name:"Download"}),w={class:"icon",width:"200",height:"200",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},f=(0,a._)("path",{fill:"currentColor",d:"M160 832h704a32 32 0 110 64H160a32 32 0 110-64zm384-253.696l236.288-236.352 45.248 45.248L508.8 704 192 387.2l45.248-45.248L480 584.704V128h64v450.304z"},null,-1),h=[f];function v(e,t,n,o,s,l){return(0,a.wg)(),(0,a.iD)("svg",w,h)}var S=(0,g.Z)(m,[["render",v]]),y=n(2167),I=n(3658),k=(0,a.aZ)({components:{MoreFilled:d.Z},props:{songList:Array,show:{default:!1}},emits:["changeData"],setup(e){const{getSongTitle:t,getSingerName:n,playMusic:o,checkStatus:s,downloadMusic:l}=(0,u.Z)(),{proxy:r}=(0,a.FN)(),d=(0,c.oR)(),{songList:g}=(0,i.BK)(e),m=(0,i.qj)({dislike:I.JO.Dislike,like:I.JO.Like}),w=(0,a.Fl)((()=>d.getters.songUrl)),f=(0,a.Fl)((()=>d.getters.singerName)),h=(0,a.Fl)((()=>d.getters.songTitle)),v=(0,a.Fl)((()=>{const e=[];return g.value.forEach(((a,o)=>{a["songName"]=t(a.name),a["singerName"]=n(a.name),a["index"]=o,e.push(a)})),e}));function k(e){o({id:e.id,url:e.url,pic:e.pic,index:e.index,name:e.name,lyric:e.lyric,currentSongList:g.value})}function C(e){console.log("row",e)}const _=(0,a.Fl)((()=>d.getters.userId));async function b({id:e}){if(!s())return;const t=new URLSearchParams;t.append("userId",_.value),t.append("type","0"),t.append("songId",e);const n=await y.x.deleteCollection(t);r.$message({message:n.message,type:n.type}),!1===n.data&&r.$emit("changeData",n.data)}return{dataList:v,iconList:m,Delete:p.Z,Download:S,songUrl:w,singerName:f,songTitle:h,handleClick:k,handleEdit:C,downloadMusic:l,deleteCollection:b}}}),C=n(89);const _=(0,C.Z)(k,[["render",r],["__scopeId","data-v-45d5c4cc"]]);var b=_},3089:function(e,t,n){n.d(t,{Z:function(){return u}});var a=n(3396);const o={class:"icon","aria-hidden":"true"},s=["xlink:href"];function l(e,t,n,l,r,i){return(0,a.wg)(),(0,a.iD)("svg",o,[(0,a._)("use",{"xlink:href":e.icon},null,8,s)])}var r=(0,a.aZ)({props:{icon:String}}),i=n(89);const c=(0,i.Z)(r,[["render",l]]);var u=c},1948:function(e,t,n){n.r(t),n.d(t,{default:function(){return y}});var a=n(3396),o=n(7139);const s=e=>((0,a.dD)("data-v-386e32ba"),e=e(),(0,a.Cn)(),e),l={class:"album-info"},r=s((()=>(0,a._)("h1",null,"简介",-1))),i={class:"album-score"},c=s((()=>(0,a._)("h3",null,"歌单评分",-1)));function u(e,t,n,s,u,d){const p=(0,a.up)("el-image"),g=(0,a.up)("el-aside"),m=(0,a.up)("el-rate"),w=(0,a.up)("song-list"),f=(0,a.up)("comment"),h=(0,a.up)("el-main"),v=(0,a.up)("el-container");return(0,a.wg)(),(0,a.j4)(v,null,{default:(0,a.w5)((()=>[(0,a.Wm)(g,{class:"album-slide"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{class:"album-img",fit:"contain",src:e.attachImageUrl(e.songDetails.pic)},null,8,["src"]),(0,a._)("h3",l,(0,o.zw)(e.songDetails.title),1)])),_:1}),(0,a.Wm)(h,{class:"album-main"},{default:(0,a.w5)((()=>[r,(0,a._)("p",null,(0,o.zw)(e.songDetails.introduction),1),(0,a._)("div",i,[(0,a._)("div",null,[c,(0,a.Wm)(m,{modelValue:e.rank,"onUpdate:modelValue":t[0]||(t[0]=t=>e.rank=t),"allow-half":"",disabled:""},null,8,["modelValue"])]),(0,a._)("span",null,(0,o.zw)(2*e.rank),1),(0,a._)("div",null,[(0,a._)("h3",null,(0,o.zw)(e.assistText)+" "+(0,o.zw)(2*e.score),1),(0,a.Wm)(m,{"allow-half":"",modelValue:e.score,"onUpdate:modelValue":t[1]||(t[1]=t=>e.score=t),disabled:e.disabledRank,onClick:t[2]||(t[2]=t=>e.pushValue())},null,8,["modelValue","disabled"])])]),(0,a.Wm)(w,{class:"album-body",songList:e.currentSongList},null,8,["songList"]),(0,a.Wm)(f,{playId:e.songListId,type:1},null,8,["playId"])])),_:1})])),_:1})}var d=n(4870),p=n(9749),g=n(8045),m=n(373),w=n(4243),f=n(2167),h=(0,a.aZ)({components:{SongList:m.Z,Comment:w.Z},setup(){const{proxy:e}=(0,a.FN)(),t=(0,p.oR)(),{checkStatus:n}=(0,g.Z)(),o=(0,d.iH)([]),s=(0,d.iH)(""),l=(0,d.iH)(0),r=(0,d.iH)(0),i=(0,d.iH)(!1),c=(0,d.iH)("评价"),u=(0,a.Fl)((()=>t.getters.songDetails)),m=(0,a.Fl)((()=>t.getters.userId));async function w(e){const t=await f.x.getListSongOfSongId(e);for(const n of t.data){const e=await f.x.getSongOfId(n.songId);o.value.push(e.data[0])}}async function h(e){const t=await f.x.getRankOfSongListId(e);r.value=t.data/2}async function v(e,t){const n=await f.x.getUserRank(e,t);l.value=n.data/2,i.value=!0,c.value="已评价"}async function S(){if(i.value||!n())return;const t=new URLSearchParams;t.append("songListId",s.value),t.append("consumerId",m.value),t.append("score",(2*l.value).toString());try{const n=await f.x.setRank(t);e.$message({message:n.message,type:n.type}),n.success&&(h(s.value),i.value=!0,c.value="已评价")}catch(a){console.error(a)}}return s.value=u.value.id,v(m.value,s.value),h(s.value),w(s.value),{songDetails:u,rank:r,score:l,disabledRank:i,assistText:c,currentSongList:o,songListId:s,attachImageUrl:f.x.attachImageUrl,pushValue:S}}}),v=n(89);const S=(0,v.Z)(h,[["render",u],["__scopeId","data-v-386e32ba"]]);var y=S}}]);
//# sourceMappingURL=948.c1232954.js.map