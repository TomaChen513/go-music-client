"use strict";(self["webpackChunkmusic_client"]=self["webpackChunkmusic_client"]||[]).push([[217],{8045:function(e,n,a){a.d(n,{Z:function(){return i}});var t=a(3396),o=a(9749),l=a(3658),s=a(2167);function i(){const{proxy:e}=(0,t.FN)(),n=(0,o.oR)(),a=(0,t.Fl)((()=>n.getters.token));function i(e){return 0===e?"女":1===e?"男":void 0}function r(e){return e.split("-")[1]}function c(e){return e.split("-")[0]}function u(n){return!!a.value||(!1!==n&&e.$message({message:"请先登录",type:"warning"}),!1)}function d({id:n,url:a,pic:t,index:o,name:l,lyric:s,currentSongList:i}){const u=r(l),d=c(l);e.$store.dispatch("playMusic",{id:n,url:a,pic:t,index:o,songTitle:u,singerName:d,lyric:s,currentSongList:i})}async function g({songUrl:n,songName:a}){if(!n)return e.$message({message:"下载链接为空！",type:"error"}),void console.error("下载链接为空！");const t=await s.x.downloadMusic(n),o=document.createElement("a");o.download=`${a}.mp3`,o.style.display="none";const l=new Blob([t.data]);o.href=URL.createObjectURL(l),document.body.appendChild(o),o.click(),document.body.removeChild(o)}function p(n){e.$store.commit("setActiveNavName",n)}function w(n,a){switch(n){case l.wC.Search:e.$router.push({path:a.path,query:a.query});break;case l.wC.Home:case l.wC.SongSheet:case l.wC.SongSheetDetail:case l.wC.Singer:case l.wC.SingerDetail:case l.wC.Personal:case l.wC.PersonalData:case l.wC.Setting:case l.wC.SignIn:case l.wC.SignUp:case l.wC.SignOut:case l.wC.Lyric:case l.wC.Error:default:e.$router.push({path:a.path});break}}function m(n=-1){e.$router.go(n)}return{getUserSex:i,getSongTitle:r,getSingerName:c,changeIndex:p,checkStatus:u,playMusic:d,routerManager:w,goBack:m,downloadMusic:g}}},373:function(e,n,a){a.d(n,{Z:function(){return x}});var t=a(3396);const o={class:"content"},l=(0,t.Uk)("下载"),s=(0,t.Uk)("删除");function i(e,n,a,i,r,c){const u=(0,t.up)("el-table-column"),d=(0,t.up)("MoreFilled"),g=(0,t.up)("el-icon"),p=(0,t.up)("el-dropdown-item"),w=(0,t.up)("el-dropdown-menu"),m=(0,t.up)("el-dropdown"),f=(0,t.up)("el-table");return(0,t.wg)(),(0,t.iD)("div",o,[(0,t.Wm)(f,{"highlight-current-row":"",data:e.dataList,onRowClick:e.handleClick},{default:(0,t.w5)((()=>[(0,t.Wm)(u,{prop:"songName",label:"歌曲"}),(0,t.Wm)(u,{prop:"singerName",label:"歌手"}),(0,t.Wm)(u,{prop:"introduction",label:"专辑"}),(0,t.Wm)(u,{label:"编辑",width:"80",align:"center"},{default:(0,t.w5)((n=>[(0,t.Wm)(m,null,{dropdown:(0,t.w5)((()=>[(0,t.Wm)(w,null,{default:(0,t.w5)((()=>[(0,t.Wm)(p,{icon:e.Download,onClick:a=>e.downloadMusic({songUrl:n.row.url,songName:n.row.name})},{default:(0,t.w5)((()=>[l])),_:2},1032,["icon","onClick"]),e.show?((0,t.wg)(),(0,t.j4)(p,{key:0,icon:e.Delete,onClick:a=>e.deleteCollection({id:n.row.id})},{default:(0,t.w5)((()=>[s])),_:2},1032,["icon","onClick"])):(0,t.kq)("",!0)])),_:2},1024)])),default:(0,t.w5)((()=>[(0,t.Wm)(g,{onClick:a=>e.handleEdit(n.row)},{default:(0,t.w5)((()=>[(0,t.Wm)(d)])),_:2},1032,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data","onRowClick"])])}var r=a(4870),c=a(9749),u=a(8045),d=a(9092),g=a(547),p=a(6854);const w=(0,t.aZ)({name:"Download"}),m={class:"icon",width:"200",height:"200",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},f=(0,t._)("path",{fill:"currentColor",d:"M160 832h704a32 32 0 110 64H160a32 32 0 110-64zm384-253.696l236.288-236.352 45.248 45.248L508.8 704 192 387.2l45.248-45.248L480 584.704V128h64v450.304z"},null,-1),h=[f];function v(e,n,a,o,l,s){return(0,t.wg)(),(0,t.iD)("svg",m,h)}var C=(0,p.Z)(w,[["render",v]]),y=a(2167),_=a(3658),k=(0,t.aZ)({components:{MoreFilled:d.Z},props:{songList:Array,show:{default:!1}},emits:["changeData"],setup(e){const{getSongTitle:n,getSingerName:a,playMusic:o,checkStatus:l,downloadMusic:s}=(0,u.Z)(),{proxy:i}=(0,t.FN)(),d=(0,c.oR)(),{songList:p}=(0,r.BK)(e),w=(0,r.qj)({dislike:_.JO.Dislike,like:_.JO.Like}),m=(0,t.Fl)((()=>d.getters.songUrl)),f=(0,t.Fl)((()=>d.getters.singerName)),h=(0,t.Fl)((()=>d.getters.songTitle)),v=(0,t.Fl)((()=>{const e=[];return p.value.forEach(((t,o)=>{t["songName"]=n(t.name),t["singerName"]=a(t.name),t["index"]=o,e.push(t)})),e}));function k(e){o({id:e.id,url:e.url,pic:e.pic,index:e.index,name:e.name,lyric:e.lyric,currentSongList:p.value})}function S(e){console.log("row",e)}const b=(0,t.Fl)((()=>d.getters.userId));async function x({id:e}){if(!l())return;const n=new URLSearchParams;n.append("userId",b.value),n.append("type","0"),n.append("songId",e);const a=await y.x.deleteCollection(n);i.$message({message:a.message,type:a.type}),!1===a.data&&i.$emit("changeData",a.data)}return{dataList:v,iconList:w,Delete:g.Z,Download:C,songUrl:m,singerName:f,songTitle:h,handleClick:k,handleEdit:S,downloadMusic:s,deleteCollection:x}}}),S=a(89);const b=(0,S.Z)(k,[["render",i],["__scopeId","data-v-45d5c4cc"]]);var x=b},9217:function(e,n,a){a.r(n),a.d(n,{default:function(){return E}});var t=a(3396),o=a(7139);const l={class:"personal"},s={class:"personal-info"},i={class:"personal-msg"},r={class:"username"},c={class:"introduction"},u=(0,t.Uk)("修改个人信息"),d={class:"personal-body"};function g(e,n,a,g,p,w){const m=(0,t.up)("el-image"),f=(0,t.up)("el-button"),h=(0,t.up)("song-list"),v=(0,t.up)("upload"),C=(0,t.up)("el-dialog");return(0,t.wg)(),(0,t.iD)("div",l,[(0,t._)("div",s,[(0,t.Wm)(m,{class:"personal-img",fit:"contain",src:e.attachImageUrl(e.userPic),onClick:n[0]||(n[0]=n=>e.dialogTableVisible=!0)},null,8,["src"]),(0,t._)("div",i,[(0,t._)("div",r,(0,o.zw)(e.personalInfo.username),1),(0,t._)("div",c,(0,o.zw)(e.personalInfo.introduction),1)]),(0,t.Wm)(f,{class:"edit-info",round:"",icon:e.Edit,onClick:n[1]||(n[1]=n=>e.goPage())},{default:(0,t.w5)((()=>[u])),_:1},8,["icon"])]),(0,t._)("div",d,[(0,t.Wm)(h,{songList:e.collectSongList,show:!0,onChangeData:e.changeData},null,8,["songList","onChangeData"])]),(0,t.Wm)(C,{modelValue:e.dialogTableVisible,"onUpdate:modelValue":n[2]||(n[2]=n=>e.dialogTableVisible=n),title:"修改头像"},{default:(0,t.w5)((()=>[(0,t.Wm)(v)])),_:1},8,["modelValue"])])}var p=a(4870),w=a(9749),m=a(6854);const f=(0,t.aZ)({name:"Edit"}),h={class:"icon",width:"200",height:"200",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},v=(0,t._)("path",{fill:"currentColor",d:"M832 512a32 32 0 1164 0v352a32 32 0 01-32 32H160a32 32 0 01-32-32V160a32 32 0 0132-32h352a32 32 0 010 64H192v640h640V512z"},null,-1),C=(0,t._)("path",{fill:"currentColor",d:"M469.952 554.24l52.8-7.552L847.104 222.4a32 32 0 10-45.248-45.248L477.44 501.44l-7.552 52.8zm422.4-422.4a96 96 0 010 135.808l-331.84 331.84a32 32 0 01-18.112 9.088L436.8 623.68a32 32 0 01-36.224-36.224l15.104-105.6a32 32 0 019.024-18.112l331.904-331.84a96 96 0 01135.744 0z"},null,-1),y=[v,C];function _(e,n,a,o,l,s){return(0,t.wg)(),(0,t.iD)("svg",h,y)}var k=(0,m.Z)(f,[["render",_]]),S=a(373);const b=e=>((0,t.dD)("data-v-1260fc69"),e=e(),(0,t.Cn)(),e),x={class:"upload"},U=b((()=>(0,t._)("div",{class:"el-upload__text"},"将文件拖到此处或点击上传",-1))),L={class:"el-upload__tip"};function D(e,n,a,l,s,i){const r=(0,t.up)("upload-filled"),c=(0,t.up)("el-icon"),u=(0,t.up)("el-upload");return(0,t.wg)(),(0,t.iD)("div",x,[(0,t.Wm)(u,{drag:"",action:e.uploadUrl(),"show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload},{tip:(0,t.w5)((()=>[(0,t._)("p",L,"只能上传 "+(0,o.zw)(e.uploadTypes.join("、"))+" 文件, 且不超过10M",1)])),default:(0,t.w5)((()=>[(0,t.Wm)(c,{class:"el-icon--upload"},{default:(0,t.w5)((()=>[(0,t.Wm)(r)])),_:1}),U])),_:1},8,["action","on-success","before-upload"])])}const I=(0,t.aZ)({name:"UploadFilled"}),Z={class:"icon",width:"200",height:"200",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},M=(0,t._)("path",{fill:"currentColor",d:"M544 864V672h128L512 480 352 672h128v192H320v-1.6c-5.376.32-10.496 1.6-16 1.6A240 240 0 0164 624c0-123.136 93.12-223.488 212.608-237.248A239.808 239.808 0 01512 192a239.872 239.872 0 01235.456 194.752c119.488 13.76 212.48 114.112 212.48 237.248a240 240 0 01-240 240c-5.376 0-10.56-1.28-16-1.6v1.6H544z"},null,-1),W=[M];function F(e,n,a,o,l,s){return(0,t.wg)(),(0,t.iD)("svg",Z,W)}var N=(0,m.Z)(I,[["render",F]]),$=a(2167),T=(0,t.aZ)({components:{UploadFilled:N},setup(){const{proxy:e}=(0,t.FN)(),n=(0,w.oR)(),a=(0,p.iH)(["jpg","jpeg","png","gif"]),o=(0,t.Fl)((()=>n.getters.userId));function l(){return $.x.uploadUrl(o.value)}function s(n){const t=2,o=n.size/1024/1024,l=a.value.includes(n.type.replace(/image\//,""));return(o>t||o<=0)&&e.$message.error(`图片大小范围是 0~${t}MB!`),l||e.$message.error(`图片只支持 ${a.value.join("、")} 格式!`),o&&l}function i(n,a){e.$message({message:n.message,type:n.type}),n.success&&e.$store.commit("setUserPic",n.data)}return{uploadTypes:a,uploadUrl:l,beforeAvatarUpload:s,handleAvatarSuccess:i}}}),V=a(89);const z=(0,V.Z)(T,[["render",D],["__scopeId","data-v-1260fc69"]]);var P=z,H=a(8045),R=a(3658),j=(0,t.aZ)({components:{SongList:S.Z,Upload:P},setup(){const e=(0,w.oR)(),{routerManager:n}=(0,H.Z)(),a=(0,p.iH)(!1),o=(0,p.iH)([]),l=(0,p.qj)({username:"",userSex:"",birth:"",location:"",introduction:""}),s=(0,t.Fl)((()=>e.getters.userId)),i=(0,t.Fl)((()=>e.getters.userPic));function r(){n(R.wC.Setting,{path:R.wC.Setting})}async function c(e){const n=await $.x.getUserOfId(e);l.username=n.data[0].username,l.userSex=n.data[0].sex,l.birth=n.data[0].birth,l.introduction=n.data[0].introduction,l.location=n.data[0].location}async function u(e){o.value=[];const n=await $.x.getCollectionOfUser(e),a=n.data||[];for(const t of a){const e=await $.x.getSongOfId(t.songId);o.value.push(e.data[0])}}function d(){u(s.value)}return(0,t.YP)(i,(()=>{a.value=!1})),(0,t.Y3)((()=>{c(s.value),u(s.value)})),{Edit:k,userPic:i,dialogTableVisible:a,collectSongList:o,personalInfo:l,attachImageUrl:$.x.attachImageUrl,goPage:r,changeData:d}}});const A=(0,V.Z)(j,[["render",g],["__scopeId","data-v-e0760d08"]]);var E=A}}]);
//# sourceMappingURL=217.a86cc18c.js.map