"use strict";(self["webpackChunkmusic_client"]=self["webpackChunkmusic_client"]||[]).push([[438,862],{8045:function(e,t,a){a.d(t,{Z:function(){return s}});var r=a(3396),n=a(9749),o=a(3658),l=a(2167);function s(){const{proxy:e}=(0,r.FN)(),t=(0,n.oR)(),a=(0,r.Fl)((()=>t.getters.token));function s(e){return 0===e?"女":1===e?"男":void 0}function u(e){return e.split("-")[1]}function i(e){return e.split("-")[0]}function d(t){return!!a.value||(!1!==t&&e.$message({message:"请先登录",type:"warning"}),!1)}function c({id:t,url:a,pic:r,index:n,name:o,lyric:l,currentSongList:s}){const d=u(o),c=i(o);e.$store.dispatch("playMusic",{id:t,url:a,pic:r,index:n,songTitle:d,singerName:c,lyric:l,currentSongList:s})}async function m({songUrl:t,songName:a}){if(!t)return e.$message({message:"下载链接为空！",type:"error"}),void console.error("下载链接为空！");const r=await l.x.downloadMusic(t),n=document.createElement("a");n.download=`${a}.mp3`,n.style.display="none";const o=new Blob([r.data]);n.href=URL.createObjectURL(o),document.body.appendChild(n),n.click(),document.body.removeChild(n)}function p(t){e.$store.commit("setActiveNavName",t)}function g(t,a){switch(t){case o.wC.Search:e.$router.push({path:a.path,query:a.query});break;case o.wC.Home:case o.wC.SongSheet:case o.wC.SongSheetDetail:case o.wC.Singer:case o.wC.SingerDetail:case o.wC.Personal:case o.wC.PersonalData:case o.wC.Setting:case o.wC.SignIn:case o.wC.SignUp:case o.wC.SignOut:case o.wC.Lyric:case o.wC.Error:default:e.$router.push({path:a.path});break}}function w(t=-1){e.$router.go(t)}return{getUserSex:s,getSongTitle:u,getSingerName:i,changeIndex:p,checkStatus:d,playMusic:c,routerManager:g,goBack:w,downloadMusic:m}}},2024:function(e,t,a){function r(e){if(null==e||""==e)return"";const t=new Date(e),a=t.getFullYear(),r=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,n=t.getDate()<10?"0"+t.getDate():t.getDate();return a+"-"+r+"-"+n}function n(e){if(null==e||""==e)return"";const t=new Date(e),a=t.getFullYear(),r=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,n=t.getDate()<10?"0"+t.getDate():t.getDate(),o=t.getHours()<10?"0"+t.getHours():t.getHours(),l=t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes(),s=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds();return a+"-"+r+"-"+n+" "+o+":"+l+":"+s}function o(e){let t=e.split("\n");const a=/\[\d{2}:\d{2}.(\d{3}|\d{2})\]/g,r=[];if(!/\[.+\]/.test(e))return[[0,e]];while(!a.test(t[0]))t=t.slice(1);0===t[t.length-1].length&&t.pop();for(const n of t){const e=n.match(a),t=n.replace(a,"");for(const a of e){const e=a.slice(1,-1).split(":");""!==t&&r.push([60*parseInt(e[0],10)+parseFloat(e[1]),t])}}return r.sort(((e,t)=>e[0]-t[0])),r}function l(e){let t=parseInt(e),a=0,r=0;t>60&&(a=parseInt((t/60).toString()),t=parseInt((t%60).toString()),a>60&&(r=parseInt((a/60).toString()),a=60));let n="";return n=parseInt(t.toString())<10?"0:0"+parseInt(t.toString()):"0:"+parseInt(t.toString()),a>0&&(n=parseInt(t.toString())<10?"0"+parseInt(t.toString()):parseInt(t.toString()).toString(),n=parseInt(a.toString())+":"+n),r>0&&(n=parseInt(t.toString())<10?"0"+parseInt(t.toString()):parseInt(t.toString()).toString(),n=parseInt(r.toString())+":"+parseInt(a.toString())+":"+n),n}a.d(t,{oy:function(){return r},p6:function(){return n},zu:function(){return o},ZC:function(){return l}})},4862:function(e,t,a){a.r(t),a.d(t,{default:function(){return y}});var r=a(3396);const n=(0,r.Uk)("女"),o=(0,r.Uk)("男"),l=(0,r.Uk)("保密"),s=(0,r.Uk)("取消"),u=(0,r.Uk)("保存");function i(e,t,a,i,d,c){const m=(0,r.up)("el-input"),p=(0,r.up)("el-form-item"),g=(0,r.up)("el-radio"),w=(0,r.up)("el-radio-group"),f=(0,r.up)("el-date-picker"),h=(0,r.up)("el-option"),b=(0,r.up)("el-select"),y=(0,r.up)("el-button"),S=(0,r.up)("el-form");return(0,r.wg)(),(0,r.j4)(S,{ref:"updateForm","label-width":"70px",model:e.registerForm,rules:e.SignUpRules},{default:(0,r.w5)((()=>[(0,r.Wm)(p,{prop:"username",label:"用户名"},{default:(0,r.w5)((()=>[(0,r.Wm)(m,{modelValue:e.registerForm.username,"onUpdate:modelValue":t[0]||(t[0]=t=>e.registerForm.username=t),placeholder:"用户名"},null,8,["modelValue"])])),_:1}),(0,r.Wm)(p,{label:"性别"},{default:(0,r.w5)((()=>[(0,r.Wm)(w,{modelValue:e.registerForm.sex,"onUpdate:modelValue":t[1]||(t[1]=t=>e.registerForm.sex=t)},{default:(0,r.w5)((()=>[(0,r.Wm)(g,{label:0},{default:(0,r.w5)((()=>[n])),_:1}),(0,r.Wm)(g,{label:1},{default:(0,r.w5)((()=>[o])),_:1}),(0,r.Wm)(g,{label:2},{default:(0,r.w5)((()=>[l])),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,r.Wm)(p,{prop:"birth",label:"生日"},{default:(0,r.w5)((()=>[(0,r.Wm)(f,{type:"date",placeholder:"选择日期",modelValue:e.registerForm.birth,"onUpdate:modelValue":t[2]||(t[2]=t=>e.registerForm.birth=t),style:{width:"100%"}},null,8,["modelValue"])])),_:1}),(0,r.Wm)(p,{prop:"introduction",label:"签名"},{default:(0,r.w5)((()=>[(0,r.Wm)(m,{type:"textarea",placeholder:"签名",modelValue:e.registerForm.introduction,"onUpdate:modelValue":t[3]||(t[3]=t=>e.registerForm.introduction=t)},null,8,["modelValue"])])),_:1}),(0,r.Wm)(p,{prop:"location",label:"地区"},{default:(0,r.w5)((()=>[(0,r.Wm)(b,{modelValue:e.registerForm.location,"onUpdate:modelValue":t[4]||(t[4]=t=>e.registerForm.location=t),placeholder:"地区",style:{width:"100%"}},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.AREA,(e=>((0,r.wg)(),(0,r.j4)(h,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,r.Wm)(p,{prop:"phoneNum",label:"手机"},{default:(0,r.w5)((()=>[(0,r.Wm)(m,{placeholder:"手机",modelValue:e.registerForm.phoneNum,"onUpdate:modelValue":t[5]||(t[5]=t=>e.registerForm.phoneNum=t)},null,8,["modelValue"])])),_:1}),(0,r.Wm)(p,{prop:"email",label:"邮箱"},{default:(0,r.w5)((()=>[(0,r.Wm)(m,{modelValue:e.registerForm.email,"onUpdate:modelValue":t[6]||(t[6]=t=>e.registerForm.email=t),placeholder:"邮箱"},null,8,["modelValue"])])),_:1}),(0,r.Wm)(p,null,{default:(0,r.w5)((()=>[(0,r.Wm)(y,{onClick:t[7]||(t[7]=t=>e.goBack(-1))},{default:(0,r.w5)((()=>[s])),_:1}),(0,r.Wm)(y,{type:"primary",onClick:t[8]||(t[8]=t=>e.saveMsg())},{default:(0,r.w5)((()=>[u])),_:1})])),_:1})])),_:1},8,["model","rules"])}var d=a(4870),c=a(9749),m=a(8045),p=a(3658),g=a(2167),w=a(2024),f=(0,r.aZ)({setup(){const{proxy:e}=(0,r.FN)(),t=(0,c.oR)(),{goBack:a}=(0,m.Z)(),n=(0,d.qj)({username:"",sex:"",phoneNum:"",email:"",birth:new Date,introduction:"",location:"",userPic:""}),o=(0,r.Fl)((()=>t.getters.userId));async function l(e){const t=await g.x.getUserOfId(e);n.username=t.data[0].username,n.sex=t.data[0].sex,n.phoneNum=t.data[0].phoneNum,n.email=t.data[0].email,n.birth=t.data[0].birth,n.introduction=t.data[0].introduction,n.location=t.data[0].location,n.userPic=t.data[0].avator}async function s(){let t=!0;if(e.$refs["updateForm"].validate((e=>{if(!e)return t=!1})),!t)return;const r=new URLSearchParams;r.append("id",o.value),r.append("username",n.username),r.append("sex",n.sex),r.append("phone_num",n.phoneNum),r.append("email",n.email),r.append("birth",(0,w.oy)(n.birth)),r.append("introduction",n.introduction),r.append("location",n.location);const l=await g.x.updateUserMsg(r);e.$message({message:l.message,type:l.type}),l.success&&(e.$store.commit("setUsername",n.username),a(-1))}return(0,r.bv)((()=>{l(o.value)})),{AREA:p.q1,registerForm:n,SignUpRules:p._P,saveMsg:s,goBack:a}}}),h=a(89);const b=(0,h.Z)(f,[["render",i],["__scopeId","data-v-6c582014"]]);var y=b},7438:function(e,t,a){a.r(t),a.d(t,{default:function(){return F}});var r=a(3396);const n=e=>((0,r.dD)("data-v-de74148a"),e=e(),(0,r.Cn)(),e),o={class:"setting"},l=n((()=>(0,r._)("h1",null,"设置",-1))),s=(0,r.Uk)("注销账号");function u(e,t,a,n,u,i){const d=(0,r.up)("Personal-data"),c=(0,r.up)("el-tab-pane"),m=(0,r.up)("Password"),p=(0,r.up)("el-button"),g=(0,r.up)("el-tabs");return(0,r.wg)(),(0,r.iD)("div",o,[l,(0,r.Wm)(g,{"tab-position":"left"},{default:(0,r.w5)((()=>[(0,r.Wm)(c,{label:"个人资料",class:"content"},{default:(0,r.w5)((()=>[(0,r.Wm)(d)])),_:1}),(0,r.Wm)(c,{label:"更改密码",class:"content"},{default:(0,r.w5)((()=>[(0,r.Wm)(m)])),_:1}),(0,r.Wm)(c,{label:"账号和安全",class:"content"},{default:(0,r.w5)((()=>[(0,r.Wm)(p,{type:"danger",icon:e.Delete,onClick:e.cancelAccount},{default:(0,r.w5)((()=>[s])),_:1},8,["icon","onClick"])])),_:1})])),_:1})])}var i=a(547),d=a(4862);const c=(0,r.Uk)("重置"),m=(0,r.Uk)("确认修改");function p(e,t,a,n,o,l){const s=(0,r.up)("el-input"),u=(0,r.up)("el-form-item"),i=(0,r.up)("el-button"),d=(0,r.up)("el-form");return(0,r.wg)(),(0,r.j4)(d,{ref:"passwordForm","label-width":"70px",model:e.form,rules:e.rules},{default:(0,r.w5)((()=>[(0,r.Wm)(u,{label:"旧密码",prop:"oldPassword"},{default:(0,r.w5)((()=>[(0,r.Wm)(s,{type:"password",modelValue:e.form.oldPassword,"onUpdate:modelValue":t[0]||(t[0]=t=>e.form.oldPassword=t)},null,8,["modelValue"])])),_:1}),(0,r.Wm)(u,{label:"新密码",prop:"newPassword"},{default:(0,r.w5)((()=>[(0,r.Wm)(s,{type:"password",modelValue:e.form.newPassword,"onUpdate:modelValue":t[1]||(t[1]=t=>e.form.newPassword=t)},null,8,["modelValue"])])),_:1}),(0,r.Wm)(u,{label:"密码确认",prop:"confirmPassword"},{default:(0,r.w5)((()=>[(0,r.Wm)(s,{type:"password",modelValue:e.form.confirmPassword,"onUpdate:modelValue":t[2]||(t[2]=t=>e.form.confirmPassword=t)},null,8,["modelValue"])])),_:1}),(0,r.Wm)(u,null,{default:(0,r.w5)((()=>[(0,r.Wm)(i,{onClick:t[3]||(t[3]=t=>e.clearData())},{default:(0,r.w5)((()=>[c])),_:1}),(0,r.Wm)(i,{type:"primary",onClick:t[4]||(t[4]=t=>e.confirm())},{default:(0,r.w5)((()=>[m])),_:1})])),_:1})])),_:1},8,["model","rules"])}a(1703);var g=a(4870),w=a(9749),f=a(8045),h=a(2167),b=a(3658),y=(0,r.aZ)({setup(){const e=(0,w.oR)(),{proxy:t}=(0,r.FN)(),{goBack:a}=(0,f.Z)(),n=(0,g.qj)({oldPassword:"",newPassword:"",confirmPassword:""}),o=(0,r.Fl)((()=>e.getters.userId)),l=(0,r.Fl)((()=>e.getters.username)),s=(e,t,a)=>{""===t?a(new Error("密码不能为空")):t!==n.newPassword?a(new Error("请输入正确密码")):a()},u=(0,g.qj)({oldPassword:[{validator:b.uo,trigger:"blur",min:3}],newPassword:[{validator:b.uo,trigger:"blur",min:3}],confirmPassword:[{validator:s,trigger:"blur",min:3}]});async function i(){n.oldPassword="",n.newPassword="",n.confirmPassword=""}async function d(){let e=!0;if(t.$refs["passwordForm"].validate((t=>{if(!t)return e=!1})),!e)return;const r=new URLSearchParams;r.append("id",o.value),r.append("username",l.value),r.append("old_password",n.oldPassword),r.append("password",n.newPassword);const s=await h.x.updateUserPassword(r);t.$message({message:s.message,type:s.type}),s.success&&a()}return{form:n,clearData:i,confirm:d,rules:u}}}),S=a(89);const _=(0,S.Z)(y,[["render",p]]);var v=_,W=(0,r.aZ)({components:{PersonalData:d["default"],Password:v},setup(){const{proxy:e}=(0,r.FN)(),t=(0,w.oR)(),{routerManager:a}=(0,f.Z)(),n=(0,r.Fl)((()=>t.getters.userId));async function o(){const t=await h.x.deleteUser(n.value);e.$message({message:t.message,type:t.type}),a(b.wC.SignIn,{path:b.wC.SignIn}),e.$store.commit("setToken",!1)}return{Delete:i.Z,cancelAccount:o}}});const P=(0,S.Z)(W,[["render",u],["__scopeId","data-v-de74148a"]]);var F=P}}]);
//# sourceMappingURL=438.d5568bee.js.map